{% extends "base.html" %}

{% block title %}{% if year == current_year %}Standings{% else %}Archive {{ year }}{% endif %}{% endblock title %}


{% block content %}
<script src="https://cdn.jsdelivr.net/npm/ag-grid-community@31.0.3/dist/ag-grid-community.min.js"></script>
<script>
    const GRID_DATA = {{ standings|tojson }};
</script>

<div class="pb-5 d-flex justify-content-center mx-0">
    <div class="fs-1">
        {{ year }} Standings
    </div>
</div>

{% if winner %}
    <sl-alert class="mb-4" variant="success" open>
        <h4 class="">Congratulations!!</h4>
        {% if winner.tie and len(winner.winner) > 1 %}
            <p>We have a tie!</p>
            <p>
                The winners are
                {% for w in winner.winner %}
                    <span class="fw-bold">
                        {{ w.bracket.name }}
                    </span>
                {% endfor %}
                They were still tied after the total goals tiebreaker.
                <br>
                Congratulations to the winners
                {% for w in winner.winner %}
                    <span class="fw-bold">
                        {{ w.username }}
                    </span>
                {% endfor %}
            </p>
        {% elif winner.tie and len(winner.winner) == 1 %}
            <p>
                <span class="fw-bold">{{ winner.winner[0].bracket.name }}</span> ({{ winner.winner[0].username }}) the total goals tiebreaker and is this year's bracket challenge winner with <span class="fw-bold">{{ winner.winner[0].bracket.points }}</span> points.
            </p>
        {% else %}
            <p>
                <span class="fw-bold">{{ winner.winner[0].bracket.name }}</span> ({{ winner.winner[0].username }}) has won this year's bracket challenge with <span class="fw-bold">{{ winner.winner[0].bracket.points }}</span> points.
            </p>
        {% endif %}
    </sl-alert>
{% endif %}

<div id="standingsGrid" style="height: 800px;" class="{% if theme == 'dark' %}ag-theme-quartz-dark{% else %}ag-theme-quartz{% endif %}"></div>

<script src="/static/js/standings.mjs" type="module"></script>

{% endblock content %}